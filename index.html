<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Keep or Toss</title>

<style>
body{margin:0;background:#0b0c10;color:#e8e8ea;font-family:system-ui}
.wrap{max-width:420px;margin:0 auto;padding:16px}
.card{background:#111318;border-radius:16px;padding:14px}
img{width:100%;border-radius:12px;margin-top:10px}
.pao{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px}
button{padding:10px;border-radius:10px;border:none;background:#1f2430;color:#fff;font-weight:700}
button.active{outline:2px solid #20c997}
.result{margin-top:12px;font-weight:800}
.ok{color:#20c997}.warn{color:#ffcc00}.err{color:#ff4d4f}
input[type="date"]{width:100%;margin-top:10px;padding:8px;border-radius:8px;border:none}
</style>
</head>

<body>
<div class="wrap">
  <h2>Keep or Toss</h2>

  <div class="card">
    <input type="file" id="file" accept="image/*">
    <img id="preview" style="display:none">

    <input type="date" id="opened">

    <div class="pao" id="paoBtns"></div>

    <div id="result" class="result"></div>
  </div>
</div>

<script>
const PAOS=[3,6,9,12,18,24,36];
let selectedPAO=null;
let openedDateStr=null;

const paoBox=document.getElementById("paoBtns");
PAOS.forEach(m=>{
  const b=document.createElement("button");
  b.textContent=m+"M";
  b.onclick=()=>{
    selectPAO(m);
    updateResult();
  };
  paoBox.appendChild(b);
});

function selectPAO(m){
  selectedPAO=m;
  [...paoBox.children].forEach(b=>{
    b.classList.toggle("active",b.textContent===m+"M");
  });
}

function addMonths(dateStr,months){
  const [y,m,d]=dateStr.split("-").map(Number);
  const dt=new Date(y,m-1,d);
  dt.setMonth(dt.getMonth()+months);
  return dt;
}

function updateResult(){
  const r=document.getElementById("result");
  if(!openedDateStr||!selectedPAO){
    r.className="result warn";
    r.textContent="ë‚ ì§œì™€ PAOë¥¼ ì„ íƒí•˜ì„¸ìš”";
    return;
  }

  const tossDate=addMonths(openedDateStr,selectedPAO);
  const today=new Date();
  const daysLeft=Math.floor((tossDate-today)/86400000);

  let cls="ok",txt="SAFE TO USE";
  if(daysLeft<0){cls="err";txt="TOSS IT";}
  else if(daysLeft<=30){cls="warn";txt="USE SOON";}

  r.className="result "+cls;
  r.textContent=
    `${txt} Â· ${selectedPAO}M Â· Toss at ${tossDate.toISOString().slice(0,10)}`;
}

document.getElementById("opened").onchange=e=>{
  openedDateStr=e.target.value;
  updateResult();
};

document.getElementById("file").onchange=e=>{
  const file=e.target.files[0];
  if(!file)return;

  const reader=new FileReader();
  reader.onload=()=>{
    const img=document.getElementById("preview");
    img.src=reader.result;
    img.style.display="block";

    // ğŸ”´ ì„ì‹œ: íŒŒì¼ëª…ì— 3m/6m/12m ìˆìœ¼ë©´ ìë™ ì„ íƒ
    const name=file.name.toLowerCase();
    if(name.includes("3m")) selectPAO(3);
    else if(name.includes("6m")) selectPAO(6);
    else if(name.includes("9m")) selectPAO(9);
    else if(name.includes("12m")) selectPAO(12);

    updateResult();
  };
  reader.readAsDataURL(file);
};
</script>
</body>
</html>
