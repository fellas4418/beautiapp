<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Keep or Toss</title>

<style>
  :root {
    --bg:#0b0c10;
    --card:#111318;
    --text:#e8e8ea;
    --muted:#9aa0aa;
    --ok:#20c997;
    --danger:#ff4d4f;
    --btn:#1f2430;
    --accent:#2b6cff;
    --radius:14px;
  }

  * { box-sizing:border-box; }
  body {
    margin:0;
    background:var(--bg);
    color:var(--text);
    font-family:system-ui, -apple-system, Segoe UI, Roboto;
  }

  .wrap {
    max-width:420px;
    margin:0 auto;
    padding:16px;
  }

  h1 {
    margin:0 0 12px;
    font-size:22px;
  }

  .card {
    background:var(--card);
    border-radius:var(--radius);
    padding:14px;
    margin-bottom:12px;
  }

  input[type="file"],
  input[type="date"] {
    width:100%;
    padding:10px;
    background:#0f1116;
    color:var(--text);
    border:1px solid #222;
    border-radius:10px;
  }

  img {
    width:100%;
    border-radius:12px;
    margin-top:10px;
    display:none;
  }

  .pao-grid {
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:8px;
    margin-top:12px;
  }

  .pao-btn {
    background:var(--btn);
    border:1px solid #2a2f3a;
    color:var(--text);
    padding:10px 0;
    border-radius:10px;
    font-weight:600;
  }

  .pao-btn.active {
    background:var(--accent);
  }

  .result {
    margin-top:14px;
    text-align:center;
    font-size:15px;
  }

  .status-ok { color:var(--ok); }
  .status-bad { color:var(--danger); }

</style>
</head>

<body>
<div class="wrap">
  <h1>Keep or Toss</h1>

  <div class="card">
    <input type="file" id="photo" accept="image/*" />
    <img id="preview" />
  </div>

  <div class="card">
    <input type="date" id="opened" />
    <div class="pao-grid">
      <button class="pao-btn" data-m="3">3M</button>
      <button class="pao-btn" data-m="6">6M</button>
      <button class="pao-btn" data-m="9">9M</button>
      <button class="pao-btn" data-m="12">12M</button>
      <button class="pao-btn" data-m="18">18M</button>
      <button class="pao-btn" data-m="24">24M</button>
      <button class="pao-btn" data-m="36">36M</button>
    </div>

    <div class="result" id="result"></div>
  </div>
</div>

<script>
const photo = document.getElementById("photo");
const preview = document.getElementById("preview");
const opened = document.getElementById("opened");
const result = document.getElementById("result");
const buttons = document.querySelectorAll(".pao-btn");

let selectedPAO = null;

// ÏÇ¨ÏßÑ ÎØ∏Î¶¨Î≥¥Í∏∞
photo.addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;
  const url = URL.createObjectURL(file);
  preview.src = url;
  preview.style.display = "block";
});

// PAO ÏÑ†ÌÉù
buttons.forEach(btn => {
  btn.addEventListener("click", () => {
    buttons.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    selectedPAO = Number(btn.dataset.m);
    calculate();
  });
});

// Í≥ÑÏÇ∞
function calculate() {
  if (!opened.value || !selectedPAO) return;

  const openDate = new Date(opened.value);
  const tossDate = new Date(openDate);
  tossDate.setMonth(tossDate.getMonth() + selectedPAO);

  const today = new Date();
  const diff = Math.ceil((tossDate - today) / 86400000);

  if (diff < 0) {
    result.innerHTML =
      `<div class="status-bad">TOSS<br>ÌèêÍ∏∞Ïùº ${tossDate.toISOString().slice(0,10)}</div>`;
  } else {
    result.innerHTML =
      `<div class="status-ok">SAFE<br>${diff} days left<br>ÌèêÍ∏∞Ïùº ${tossDate.toISOString().slice(0,10)}</div>`;
  }

  // üëâ Ïó¨Í∏∞ÏÑúÎ∂ÄÌÑ∞ Îã§Ïùå Îã®Í≥ÑÎ°ú ÌôïÏû• Í∞ÄÎä•
  window.currentItem = {
    opened: opened.value,
    pao: selectedPAO,
    tossAt: tossDate.toISOString().slice(0,10),
    daysLeft: diff
  };

  console.log("currentItem", window.currentItem);
}
</script>
</body>
</html>
