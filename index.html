<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Keep or Toss – Step 2</title>

<style>
:root{
  --bg:#0b0c10;
  --card:#111318;
  --text:#e8e8ea;
  --muted:#a8abb4;
  --border:rgba(255,255,255,.10);
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:var(--bg);
  color:var(--text);
}
.wrap{max-width:720px;margin:0 auto;padding:16px;}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
}
h1{margin:0 0 6px;font-size:26px;}
.sub{color:var(--muted);font-size:14px;margin-bottom:14px}

input[type="file"]{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#1f2430;
  color:var(--text);
}

#photoPreviewWrap{
  margin-top:12px;
  display:none;
}
#photoPreview{
  max-width:100%;
  border-radius:12px;
}
.muted{
  margin-top:10px;
  font-size:13px;
  color:var(--muted);
}
</style>
</head>

<body>
<div class="wrap">
  <h1>Keep or Toss</h1>
  <div class="sub">Step 2 · Photo select → preview → base64</div>

  <div class="card">
    <input id="photoInput" type="file" accept="image/*" />

    <div id="photoPreviewWrap">
      <img id="photoPreview" />
    </div>

    <div class="muted">
      Open DevTools → Console<br>
      base64 length 로그가 나오면 성공
    </div>
  </div>
</div>

<script>
const photoInput = document.getElementById("photoInput");
const photoPreview = document.getElementById("photoPreview");
const photoPreviewWrap = document.getElementById("photoPreviewWrap");

let currentBase64 = null;

photoInput.addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;

  // 1. 미리보기
  const previewUrl = URL.createObjectURL(file);
  photoPreview.src = previewUrl;
  photoPreviewWrap.style.display = "block";

  // 2. base64 변환
  const reader = new FileReader();
  reader.onload = () => {
    const img = new Image();
    img.onload = () => {
      const canvas = document.createElement("canvas");
      const maxW = 1200;
      const scale = Math.min(1, maxW / img.width);

      canvas.width = img.width * scale;
      canvas.height = img.height * scale;

      const ctx = canvas.getContext("2d");
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

      currentBase64 = canvas.toDataURL("image/jpeg", 0.85);
      console.log("base64 length:", currentBase64.length);
    };
    img.src = reader.result;
  };
  reader.readAsDataURL(file);
});
</script>
</body>
</html>
