<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PAO OCR TEST</title>
</head>
<body style="background:#111;color:#fff;font-family:system-ui;padding:20px">

  <h2>PAO OCR ONLY TEST</h2>

  <input type="file" id="fileInput" accept="image/*" />

  <script>
    const ENDPOINT = "https://pao-ocr-worker.ohryee.workers.dev";

    document.getElementById("fileInput").onchange = async (e) => {
      const file = e.target.files[0];
      if (!file) return;

      console.log("ðŸ“¸ file selected:", file.name);

      const base64 = await toBase64(file);

      console.log("ðŸ“¦ base64 length:", base64.length);

      try {
        const res = await fetch(ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ imageBase64: base64 })
        });

        const text = await res.text();
        console.log("ðŸ§  RAW RESPONSE:", text);

        let json = null;
        try {
          json = JSON.parse(text);
        } catch {
          console.error("âŒ JSON parse failed");
        }

        console.log("âœ… PARSED JSON:", json);

      } catch (err) {
        console.error("ðŸ”¥ FETCH FAILED:", err);
      }
    };

    function toBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
          const base64 = reader.result.split(",")[1];
          resolve(base64);
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }
  </script>

</body>
</html>
